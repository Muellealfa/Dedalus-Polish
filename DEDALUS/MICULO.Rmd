---
title: "Vignette Title"
author: "Vignette Author"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---


```{r}
unique(LOD$asa_score)
```
## *Análisis exploratorio de datos*

En este apartado haremos un estudio exhaustivo del dataset fijandonos detenidamente en todas sus variables y valores.

```{r}
variables <- colnames(LOD)
variables
```

Nuestro dataset consta de varias columns como podemos ver anteriormente,a continuación haremos una breve explicación del significado de cada una de ellas y actualizaremos el dataset quedandonos solo con las que consideramos más relevantes.

Otro factor a tener en cuenta antes de meternos en profundidad es ver si hay valores NA

```{r}
ifelse(sum(is.na(LOD)) == 0,"No hay valores NA","El dataset contiene valores NA")
```
Vamos a ver cuantos NA hay en cada columna

```{r}
install.packages("dplyr")
library(dplyr)
LOD %>%
  summarise_all(.funs = function(x) sum(is.na(x)))

```
```{r}
LOD <- na.omit(LOD)
```

Vamos a crear una tabla para cada asa_score y ver qué porcentaje de cada uno hay en nuestro dataset

```{r}
asa1 <- LOD %>% filter (asa_score == 1) %>% select(c(`age`,`weight`,`height`,`gender`,`comorbidity`))
asa2 <- LOD %>% filter (asa_score == 2) %>% select(c(`age`,`weight`,`height`,`gender`,`comorbidity`))
asa3 <- LOD %>% filter (asa_score == 3) %>% select(c(`age`,`weight`,`height`,`gender`,`comorbidity`))
asa4 <- LOD %>% filter (asa_score == 4) %>% select(c(`age`,`weight`,`height`,`gender`,`comorbidity`))
asa5 <- LOD %>% filter (asa_score == 5) %>% select(c(`age`,`weight`,`height`,`gender`,`comorbidity`))
```

```{r}
(nrow(asa1)/nrow(LOD))*100
(nrow(asa2)/nrow(LOD))*100
(nrow(asa3)/nrow(LOD))*100
(nrow(asa4)/nrow(LOD))*100
(nrow(asa5)/nrow(LOD))*100
```

Hay un porcentaje mucho mayor de asa_score = 2, casi un 50% de los datos

Vamos a ver si esto influye en la comorbidity y otros valroes.

```{r}
summary(LOD$comorbidity)
```
```{r}
unique(LOD$comorbidity)
```


```{r}
(nrow(asa1 %>% filter(`comorbidity` == "lung_disease"))/nrow(asa1))*100
(nrow(asa1 %>% filter(`comorbidity` == "cancer"))/nrow(asa1))*100
(nrow(asa1 %>% filter(`comorbidity` == "heart_disease"))/nrow(asa1))*100
(nrow(asa1 %>% filter(`comorbidity` == "hypertension"))/nrow(asa1))*100
(nrow(asa1 %>% filter(`comorbidity` == "kidney_disease"))/nrow(asa1))*100
(nrow(asa1 %>% filter(`comorbidity` == "obesity"))/nrow(asa1))*100
(nrow(asa1 %>% filter(`comorbidity` == "cancer"))/nrow(asa1))*100
(nrow(asa1 %>% filter(`comorbidity` == "nan"))/nrow(asa1))*100
(nrow(asa1 %>% filter(`comorbidity` == "diabetes"))/nrow(asa1))*100
(nrow(asa1 %>% filter(`comorbidity` == "drug_abuse"))/nrow(asa1))*100
(nrow(asa1 %>% filter(`comorbidity` == "liver_disease"))/nrow(asa1))*100
(nrow(asa1 %>% filter(`comorbidity` == "alcoholism"))/nrow(asa1))*100
(nrow(asa1 %>% filter(`comorbidity` == "hiv"))/nrow(asa1))*100
(nrow(asa1 %>% filter(`comorbidity` == "smoker"))/nrow(asa1))*100
```
```{r}
(nrow(asa2 %>% filter(`comorbidity` == "lung_disease"))/nrow(asa2))*100
(nrow(asa2 %>% filter(`comorbidity` == "cancer"))/nrow(asa2))*100
(nrow(asa2 %>% filter(`comorbidity` == "heart_disease"))/nrow(asa2))*100
(nrow(asa2 %>% filter(`comorbidity` == "hypertension"))/nrow(asa2))*100
(nrow(asa2 %>% filter(`comorbidity` == "kidney_disease"))/nrow(asa2))*100
(nrow(asa2 %>% filter(`comorbidity` == "obesity"))/nrow(asa2))*100
(nrow(asa2 %>% filter(`comorbidity` == "cancer"))/nrow(asa2))*100
(nrow(asa2 %>% filter(`comorbidity` == "nan"))/nrow(asa2))*100
(nrow(asa2 %>% filter(`comorbidity` == "diabetes"))/nrow(asa2))*100
(nrow(asa2 %>% filter(`comorbidity` == "drug_abuse"))/nrow(asa2))*100
(nrow(asa2 %>% filter(`comorbidity` == "liver_disease"))/nrow(asa2))*100
(nrow(asa2 %>% filter(`comorbidity` == "alcoholism"))/nrow(asa2))*100
(nrow(asa2 %>% filter(`comorbidity` == "hiv"))/nrow(asa2))*100
(nrow(asa2 %>% filter(`comorbidity` == "smoker"))/nrow(asa2))*100
```
```{r}
(nrow(asa3 %>% filter(`comorbidity` == "lung_disease"))/nrow(asa3))*100
(nrow(asa3 %>% filter(`comorbidity` == "cancer"))/nrow(asa3))*100
(nrow(asa3 %>% filter(`comorbidity` == "heart_disease"))/nrow(asa3))*100
(nrow(asa3 %>% filter(`comorbidity` == "hypertension"))/nrow(asa3))*100
(nrow(asa3 %>% filter(`comorbidity` == "kidney_disease"))/nrow(asa3))*100
(nrow(asa3 %>% filter(`comorbidity` == "obesity"))/nrow(asa3))*100
(nrow(asa3 %>% filter(`comorbidity` == "cancer"))/nrow(asa3))*100
(nrow(asa3 %>% filter(`comorbidity` == "nan"))/nrow(asa3))*100
(nrow(asa3 %>% filter(`comorbidity` == "diabetes"))/nrow(asa3))*100
(nrow(asa3 %>% filter(`comorbidity` == "drug_abuse"))/nrow(asa3))*100
(nrow(asa3 %>% filter(`comorbidity` == "liver_disease"))/nrow(asa3))*100
(nrow(asa3 %>% filter(`comorbidity` == "alcoholism"))/nrow(asa3))*100
(nrow(asa3 %>% filter(`comorbidity` == "hiv"))/nrow(asa3))*100
(nrow(asa3 %>% filter(`comorbidity` == "smoker"))/nrow(asa3))*100
```
```{r}
(nrow(asa4 %>% filter(`comorbidity` == "lung_disease"))/nrow(asa4))*100
(nrow(asa4 %>% filter(`comorbidity` == "cancer"))/nrow(asa4))*100
(nrow(asa4 %>% filter(`comorbidity` == "heart_disease"))/nrow(asa4))*100
(nrow(asa4 %>% filter(`comorbidity` == "hypertension"))/nrow(asa4))*100
(nrow(asa4 %>% filter(`comorbidity` == "kidney_disease"))/nrow(asa4))*100
(nrow(asa4 %>% filter(`comorbidity` == "obesity"))/nrow(asa4))*100
(nrow(asa4 %>% filter(`comorbidity` == "cancer"))/nrow(asa4))*100
(nrow(asa4 %>% filter(`comorbidity` == "nan"))/nrow(asa4))*100
(nrow(asa4 %>% filter(`comorbidity` == "diabetes"))/nrow(asa4))*100
(nrow(asa4 %>% filter(`comorbidity` == "drug_abuse"))/nrow(asa4))*100
(nrow(asa4 %>% filter(`comorbidity` == "liver_disease"))/nrow(asa4))*100
(nrow(asa4 %>% filter(`comorbidity` == "alcoholism"))/nrow(asa4))*100
(nrow(asa4 %>% filter(`comorbidity` == "hiv"))/nrow(asa4))*100
(nrow(asa4 %>% filter(`comorbidity` == "smoker"))/nrow(asa4))*100
```
```{r}
(nrow(asa5 %>% filter(`comorbidity` == "lung_disease"))/nrow(asa5))*100
(nrow(asa5 %>% filter(`comorbidity` == "cancer"))/nrow(asa5))*100
(nrow(asa5 %>% filter(`comorbidity` == "heart_disease"))/nrow(asa5))*100
(nrow(asa5 %>% filter(`comorbidity` == "hypertension"))/nrow(asa5))*100
(nrow(asa5 %>% filter(`comorbidity` == "kidney_disease"))/nrow(asa5))*100
(nrow(asa5 %>% filter(`comorbidity` == "obesity"))/nrow(asa5))*100
(nrow(asa5 %>% filter(`comorbidity` == "cancer"))/nrow(asa5))*100
(nrow(asa5 %>% filter(`comorbidity` == "nan"))/nrow(asa5))*100
(nrow(asa5 %>% filter(`comorbidity` == "diabetes"))/nrow(asa5))*100
(nrow(asa5 %>% filter(`comorbidity` == "drug_abuse"))/nrow(asa5))*100
(nrow(asa5 %>% filter(`comorbidity` == "liver_disease"))/nrow(asa5))*100
(nrow(asa5 %>% filter(`comorbidity` == "alcoholism"))/nrow(asa5))*100
(nrow(asa5 %>% filter(`comorbidity` == "hiv"))/nrow(asa5))*100
(nrow(asa5 %>% filter(`comorbidity` == "smoker"))/nrow(asa5))*100
```

No hemos sacado datos muy concluyentes. Lo único que podemos decir es que el mayor porcentaje de asa score 5 proviene de pacientes con kidney_disease, seguido de lung_disease y nan. No podemos tener esto muy en cuenta ya que con asa_score = 5 hay menos de 50 casos

Estudiemos qué pasa con el género.

```{r}
summary(asa1$`gender`)
```

```{r}
unique(asa1$`gender`)
```

Comparamos con los pacientes con diferentes asa_scores

```{r}
(nrow(asa1 %>% filter(`gender` == "male"))/nrow(asa1))*100
(nrow(asa1 %>% filter(`gender` == "female"))/nrow(asa1))*100
```
```{r}
(nrow(asa2 %>% filter(`gender` == "male"))/nrow(asa2))*100
(nrow(asa2 %>% filter(`gender` == "female"))/nrow(asa2))*100
```
```{r}
(nrow(asa3 %>% filter(`gender` == "male"))/nrow(asa3))*100
(nrow(asa3 %>% filter(`gender` == "female"))/nrow(asa3))*100
```
```{r}
(nrow(asa4 %>% filter(`gender` == "male"))/nrow(asa4))*100
(nrow(asa4 %>% filter(`gender` == "female"))/nrow(asa4))*100
```
```{r}
(nrow(asa5 %>% filter(`gender` == "male"))/nrow(asa5))*100
(nrow(asa5 %>% filter(`gender` == "female"))/nrow(asa5))*100
```

Vemos que en los asa_scores mayores hay más presencia de hombres que de mujeres.

Vamos ahora a hacer una división por edades:

```{r}
(nrow(asa1 %>% filter(`age` >= 0 & age <= 5))/nrow(asa1))*100  #bebés
(nrow(asa1 %>% filter(`age` > 5 & age <= 12))/nrow(asa1))*100  #niños
(nrow(asa1 %>% filter(`age` > 12 & age <= 18))/nrow(asa1))*100 #adolescentes
(nrow(asa1 %>% filter(`age` > 18 & age <= 30))/nrow(asa1))*100 #adolescentes adultos
(nrow(asa1 %>% filter(`age` > 30 & age <= 50))/nrow(asa1))*100 #adultos
(nrow(asa1 %>% filter(`age` > 50))/nrow(asa1))*100             #mayores
```
```{r}
(nrow(asa2 %>% filter(`age` >= 0 & age <= 5))/nrow(asa2))*100  #bebés
(nrow(asa2 %>% filter(`age` > 5 & age <= 12))/nrow(asa2))*100  #niños
(nrow(asa2 %>% filter(`age` > 12 & age <= 18))/nrow(asa2))*100 #adolescentes
(nrow(asa2 %>% filter(`age` > 18 & age <= 30))/nrow(asa2))*100 #adolescentes adultos
(nrow(asa2 %>% filter(`age` > 30 & age <= 50))/nrow(asa2))*100 #adultos
(nrow(asa2 %>% filter(`age` > 50))/nrow(asa2))*100             #mayores
```
```{r}
(nrow(asa3 %>% filter(`age` >= 0 & age <= 5))/nrow(asa3))*100  #bebés
(nrow(asa3 %>% filter(`age` > 5 & age <= 12))/nrow(asa3))*100  #niños
(nrow(asa3 %>% filter(`age` > 12 & age <= 18))/nrow(asa3))*100 #adolescentes
(nrow(asa3 %>% filter(`age` > 18 & age <= 30))/nrow(asa3))*100 #adolescentes adultos
(nrow(asa3 %>% filter(`age` > 30 & age <= 50))/nrow(asa3))*100 #adultos
(nrow(asa3 %>% filter(`age` > 50))/nrow(asa3))*100             #mayores
```
```{r}
(nrow(asa4 %>% filter(`age` >= 0 & age <= 5))/nrow(asa4))*100  #bebés
(nrow(asa4 %>% filter(`age` > 5 & age <= 12))/nrow(asa4))*100  #niños
(nrow(asa4 %>% filter(`age` > 12 & age <= 18))/nrow(asa4))*100 #adolescentes
(nrow(asa4 %>% filter(`age` > 18 & age <= 30))/nrow(asa4))*100 #adolescentes adultos
(nrow(asa4 %>% filter(`age` > 30 & age <= 50))/nrow(asa4))*100 #adultos
(nrow(asa4 %>% filter(`age` > 50))/nrow(asa4))*100             #mayores
```
```{r}
(nrow(asa5 %>% filter(`age` >= 0 & age <= 5))/nrow(asa5))*100  #bebés
(nrow(asa5 %>% filter(`age` > 5 & age <= 12))/nrow(asa5))*100  #niños
(nrow(asa5 %>% filter(`age` > 12 & age <= 18))/nrow(asa5))*100 #adolescentes
(nrow(asa5 %>% filter(`age` > 18 & age <= 30))/nrow(asa5))*100 #adolescentes adultos
(nrow(asa5 %>% filter(`age` > 30 & age <= 50))/nrow(asa5))*100 #adultos
(nrow(asa5 %>% filter(`age` > 50))/nrow(asa5))*100             #mayores
```
El mayo porcentaje de pacientes con asa mayor que 1 son personas mayores. Con mas de 50 años de edad

Tampoco es muy relevante ya que el 60% de los pacientes aproximadamente son mayores

Vamos a crear una columna nueva para el IMC

Bajo peso: IMC menor a 18.5
Peso saludable: IMC entre 18.5 y 24.9
Sobrepeso: IMC entre 25 y 29.9
Obesidad: IMC de 30 o más

```{r}
asa1 <- asa1 %>%
  mutate(IMC = weight/((height/100)^2))

asa2 <- asa2 %>%
  mutate(IMC = weight/((height/100)^2))

asa3 <- asa3 %>%
  mutate(IMC = weight/((height/100)^2))

asa4 <- asa4 %>%
  mutate(IMC = weight/((height/100)^2))

asa5 <- asa5 %>%
  mutate(IMC = weight/((height/100)^2))
LOD <- LOD %>%
  mutate(IMC = weight/((height/100)^2))
```

```{r}
(nrow(asa1 %>% filter(IMC < 18.5))/nrow(asa1))*100  #Bajo peso
(nrow(asa1 %>% filter(IMC >= 18.5 & IMC < 25))/nrow(asa1))*100  #Peso saludable
(nrow(asa1 %>% filter(IMC >= 25 & IMC < 30))/nrow(asa1))*100 #Sobrepeso 
(nrow(asa1 %>% filter(IMC >= 30))/nrow(asa1))*100 #Obesidad 
```
```{r}
(nrow(asa2 %>% filter(IMC < 18.5))/nrow(asa2))*100  #Bajo peso
(nrow(asa2 %>% filter(IMC >= 18.5 & IMC < 25))/nrow(asa2))*100  #Peso saludable
(nrow(asa2 %>% filter(IMC >= 25 & IMC < 30))/nrow(asa2))*100 #Sobrepeso 
(nrow(asa2 %>% filter(IMC >= 30))/nrow(asa2))*100 #Obesidad 
```
```{r}
(nrow(asa3 %>% filter(IMC < 18.5))/nrow(asa3))*100  #Bajo peso
(nrow(asa3 %>% filter(IMC >= 18.5 & IMC < 25))/nrow(asa3))*100  #Peso saludable
(nrow(asa3 %>% filter(IMC >= 25 & IMC < 30))/nrow(asa3))*100 #Sobrepeso 
(nrow(asa3 %>% filter(IMC >= 30))/nrow(asa3))*100 #Obesidad 
```
```{r}
(nrow(asa4 %>% filter(IMC < 18.5))/nrow(asa4))*100  #Bajo peso
(nrow(asa4 %>% filter(IMC >= 18.5 & IMC < 25))/nrow(asa4))*100  #Peso saludable
(nrow(asa4 %>% filter(IMC >= 25 & IMC < 30))/nrow(asa4))*100 #Sobrepeso 
(nrow(asa4 %>% filter(IMC >= 30))/nrow(asa4))*100 #Obesidad 
```
```{r}
(nrow(asa5 %>% filter(IMC < 18.5))/nrow(asa5))*100  #Bajo peso
(nrow(asa5 %>% filter(IMC >= 18.5 & IMC < 25))/nrow(asa5))*100  #Peso saludable
(nrow(asa5 %>% filter(IMC >= 25 & IMC < 30))/nrow(asa5))*100 #Sobrepeso 
(nrow(asa5 %>% filter(IMC >= 30))/nrow(asa5))*100 #Obesidad 
```
```{r}
(nrow(LOD %>% filter(IMC < 18.5))/nrow(LOD))*100  #Bajo peso
(nrow(LOD %>% filter(IMC >= 18.5 & IMC < 25))/nrow(LOD))*100  #Peso saludable
(nrow(LOD %>% filter(IMC >= 25 & IMC < 30))/nrow(LOD))*100 #Sobrepeso 
(nrow(LOD %>% filter(IMC >= 30))/nrow(LOD))*100 #Obesidad 
```
No podemos sacar datos concluyentes en los asa pero sí podemos decir que la mayoría de pacientes del dataset son personas con obesidad.

```{r}
(nrow(LOD %>% filter(surgery_length_of_duration < 0))/nrow(LOD))*100   
(nrow(LOD %>% filter(surgery_length_of_duration >= 0 & surgery_length_of_duration < 60))/nrow(LOD))*100   
(nrow(LOD %>% filter(surgery_length_of_duration >= 60 & surgery_length_of_duration < 120))/nrow(LOD))*100  
(nrow(LOD %>% filter(surgery_length_of_duration >= 120 & surgery_length_of_duration < 180))/nrow(LOD))*100   
(nrow(LOD %>% filter(surgery_length_of_duration >= 180 & surgery_length_of_duration < 240))/nrow(LOD))*100   
(nrow(LOD %>% filter(surgery_length_of_duration >= 240 & surgery_length_of_duration < 300))/nrow(LOD))*100   
(nrow(LOD %>% filter(surgery_length_of_duration >= 300 & surgery_length_of_duration < 360))/nrow(LOD))*100 
(nrow(LOD %>% filter(surgery_length_of_duration >= 360 & surgery_length_of_duration < 420))/nrow(LOD))*100 
(nrow(LOD %>% filter(surgery_length_of_duration >= 420 & surgery_length_of_duration < 480))/nrow(LOD))*100 
(nrow(LOD %>% filter(surgery_length_of_duration >= 480 & surgery_length_of_duration < 540))/nrow(LOD))*100 
(nrow(LOD %>% filter(surgery_length_of_duration >= 540 & surgery_length_of_duration < 600))/nrow(LOD))*100 
(nrow(LOD %>% filter(surgery_length_of_duration >= 600))/nrow(LOD))*100   

```

La mayoría de las cirugías duran entre 2 y 3 horas

```{r}
negativo <- LOD %>% filter (surgery_length_of_duration < 0)
```

```{r}

(nrow(negativo %>% filter(surgery_length_of_duration < 0 & asa_score == 1))/nrow(negativo))*100   
(nrow(negativo %>% filter(surgery_length_of_duration < 0 & asa_score == 2))/nrow(negativo))*100   
(nrow(negativo %>% filter(surgery_length_of_duration < 0 & asa_score == 3))/nrow(negativo))*100   
(nrow(negativo %>% filter(surgery_length_of_duration < 0 & asa_score == 4))/nrow(negativo))*100   
(nrow(negativo %>% filter(surgery_length_of_duration < 0 & asa_score == 5))/nrow(negativo))*100   

```

los mayores tiempos negativos provienen del asa 2

Vamos a filtrar los datos según la cantidad de anestesía diferente que se aplica:

```{r}
anestesia <- LOD %>% filter  %>% select(c(asa_score, anesthesia_local, anesthesia_sedation, anesthesia_plexus_block, anesthesia_intradural, anesthesia_epidural, anesthesia_general, surgery_length_of_duration, cleaning_time, recovery_time))
anestesia
```

```{r}
conjuntas <- LOD %>%
  filter(rowSums(select(., starts_with("anesthesia")) == 1) >= 2) %>%
  select(secondary_procedure, asa_score, anesthesia_local, anesthesia_sedation, 
         anesthesia_plexus_block, anesthesia_intradural, 
         anesthesia_epidural, anesthesia_general, 
         surgery_length_of_duration, cleaning_time, recovery_time)
conjuntas
```

```{r}
individuales <- LOD %>%
  filter(rowSums(select(., starts_with("anesthesia")) == 1) == 1) %>%
  select(secondary_procedure, asa_score, anesthesia_local, anesthesia_sedation, 
         anesthesia_plexus_block, anesthesia_intradural, 
         anesthesia_epidural, anesthesia_general, 
         surgery_length_of_duration, cleaning_time, recovery_time)
individuales
```

```{r}
(nrow(conjuntas)/nrow(LOD))*100
```
```{r}
(nrow(conjuntas %>% filter(asa_score == 1))/nrow(conjuntas))*100
(nrow(conjuntas %>% filter(asa_score == 2))/nrow(conjuntas))*100
(nrow(conjuntas %>% filter(asa_score == 3))/nrow(conjuntas))*100
(nrow(conjuntas %>% filter(asa_score == 4))/nrow(conjuntas))*100
(nrow(conjuntas %>% filter(asa_score == 5))/nrow(conjuntas))*100
```
El 50% provienen del asa2 asique no es concluyentes porque el 50% de los datos de la tabla 

```{r}
(nrow(individuales)/nrow(LOD))*100
```

```{r}
(nrow(individuales %>% filter(asa_score == 1))/nrow(individuales))*100
(nrow(individuales %>% filter(asa_score == 2))/nrow(individuales))*100
(nrow(individuales %>% filter(asa_score == 3))/nrow(individuales))*100
(nrow(individuales %>% filter(asa_score == 4))/nrow(individuales))*100
(nrow(individuales %>% filter(asa_score == 5))/nrow(individuales))*100
```
Tampoco sacamos nada concluyente

```{r}
media_duration_LOD <- colMeans(LOD[, c("surgery_length_of_duration", "cleaning_time", "recovery_time")], na.rm = TRUE)
media_duration_LOD
```

```{r}
media_duration_conjuntas <- colMeans(conjuntas[, c("surgery_length_of_duration", "cleaning_time", "recovery_time")], na.rm = TRUE)
media_duration_conjuntas
```

```{r}
media_duration_individuales <- colMeans(individuales[, c("surgery_length_of_duration", "cleaning_time", "recovery_time")], na.rm = TRUE)
media_duration_individuales
```

Las medias son iguales


```{r}
(nrow(LOD %>% filter(`secondary_procedure` == 1))/nrow(LOD))*100
(nrow(conjuntas %>% filter(`secondary_procedure` == 1))/nrow(conjuntas))*100
(nrow(individuales %>% filter(`secondary_procedure` == 1))/nrow(individuales))*100
```
Se puede apreciar que los casos en los que existe un procedimiento secundario hay una tendencia un poco mayor a que se use más de un tipo de anestesia y menor a que se use solo un tipo.

cuando no hay procedimiento secundario ocurre lo contrario

```{r}
(nrow(LOD %>% filter(rowSums(select(., starts_with("anesthesia")) == 1) == 0)))
(nrow(LOD %>% filter(rowSums(select(., starts_with("anesthesia")) == 1) == 0)))/(nrow(LOD))
```

Existen casos en los que no se aplica anestesia.

```{r}
sin_anestesia <- LOD %>%
  filter(rowSums(select(., starts_with("anesthesia")) == 1) == 0) %>%
  select(comorbidity, secondary_procedure, asa_score, anesthesia_local,
         anesthesia_sedation, 
         anesthesia_plexus_block, anesthesia_intradural, 
         anesthesia_epidural, anesthesia_general, 
         surgery_length_of_duration, cleaning_time, recovery_time)
sin_anestesia
```

```{r}
(nrow(sin_anestesia %>% filter(asa_score == 1))/nrow(sin_anestesia))*100
(nrow(sin_anestesia %>% filter(asa_score == 2))/nrow(sin_anestesia))*100
(nrow(sin_anestesia %>% filter(asa_score == 3))/nrow(sin_anestesia))*100
(nrow(sin_anestesia %>% filter(asa_score == 4))/nrow(sin_anestesia))*100
(nrow(sin_anestesia %>% filter(asa_score == 5))/nrow(sin_anestesia))*100
```
```{r}
(nrow(sin_anestesia %>% filter(surgery_length_of_duration < 0))/nrow(sin_anestesia))*100   
(nrow(sin_anestesia %>% filter(surgery_length_of_duration >= 0 & surgery_length_of_duration < 60))/nrow(sin_anestesia))*100   
(nrow(sin_anestesia %>% filter(surgery_length_of_duration >= 60 & surgery_length_of_duration < 120))/nrow(sin_anestesia))*100  
(nrow(sin_anestesia %>% filter(surgery_length_of_duration >= 120 & surgery_length_of_duration < 180))/nrow(sin_anestesia))*100   
(nrow(sin_anestesia %>% filter(surgery_length_of_duration >= 180 & surgery_length_of_duration < 240))/nrow(sin_anestesia))*100   
(nrow(sin_anestesia %>% filter(surgery_length_of_duration >= 240 & surgery_length_of_duration < 300))/nrow(sin_anestesia))*100   
(nrow(sin_anestesia %>% filter(surgery_length_of_duration >= 300 & surgery_length_of_duration < 360))/nrow(sin_anestesia))*100 
(nrow(sin_anestesia %>% filter(surgery_length_of_duration >= 360 & surgery_length_of_duration < 420))/nrow(sin_anestesia))*100 
(nrow(sin_anestesia %>% filter(surgery_length_of_duration >= 420 & surgery_length_of_duration < 480))/nrow(sin_anestesia))*100 
(nrow(sin_anestesia %>% filter(surgery_length_of_duration >= 480 & surgery_length_of_duration < 540))/nrow(sin_anestesia))*100 
(nrow(sin_anestesia %>% filter(surgery_length_of_duration >= 540 & surgery_length_of_duration < 600))/nrow(sin_anestesia))*100 
(nrow(sin_anestesia %>% filter(surgery_length_of_duration >= 600))/nrow(sin_anestesia))*100   

```
Muy parecido al caso normal

```{r}
asa1 <- LOD %>% filter (asa_score == 1) %>% select(c(`age`,`weight`,`height`,`gender`,`comorbidity`, surgery_length_of_duration))
asa2 <- LOD %>% filter (asa_score == 2) %>% select(c(`age`,`weight`,`height`,`gender`,`comorbidity`,surgery_length_of_duration))
asa3 <- LOD %>% filter (asa_score == 3) %>% select(c(`age`,`weight`,`height`,`gender`,`comorbidity`,surgery_length_of_duration))
asa4 <- LOD %>% filter (asa_score == 4) %>% select(c(`age`,`weight`,`height`,`gender`,`comorbidity`,surgery_length_of_duration))
asa5 <- LOD %>% filter (asa_score == 5) %>% select(c(`age`,`weight`,`height`,`gender`,`comorbidity`,surgery_length_of_duration))
```

```{r}
(nrow(asa1 %>% filter(surgery_length_of_duration < 0))/nrow(asa1))*100   
(nrow(asa1 %>% filter(surgery_length_of_duration >= 0 & surgery_length_of_duration < 60))/nrow(asa1))*100   
(nrow(asa1 %>% filter(surgery_length_of_duration >= 60 & surgery_length_of_duration < 120))/nrow(asa1))*100  
(nrow(asa1 %>% filter(surgery_length_of_duration >= 120 & surgery_length_of_duration < 180))/nrow(asa1))*100   
(nrow(asa1 %>% filter(surgery_length_of_duration >= 180 & surgery_length_of_duration < 240))/nrow(asa1))*100   
(nrow(asa1 %>% filter(surgery_length_of_duration >= 240 & surgery_length_of_duration < 300))/nrow(asa1))*100   
(nrow(asa1 %>% filter(surgery_length_of_duration >= 300 & surgery_length_of_duration < 360))/nrow(asa1))*100 
(nrow(asa1 %>% filter(surgery_length_of_duration >= 360 & surgery_length_of_duration < 420))/nrow(asa1))*100 
(nrow(asa1 %>% filter(surgery_length_of_duration >= 420 & surgery_length_of_duration < 480))/nrow(asa1))*100 
(nrow(asa1 %>% filter(surgery_length_of_duration >= 480 & surgery_length_of_duration < 540))/nrow(asa1))*100 
(nrow(asa1 %>% filter(surgery_length_of_duration >= 540 & surgery_length_of_duration < 600))/nrow(asa1))*100 
(nrow(asa1 %>% filter(surgery_length_of_duration >= 600))/nrow(asa1))*100   
```
```{r}
(nrow(asa2 %>% filter(surgery_length_of_duration < 0))/nrow(asa2))*100   
(nrow(asa2 %>% filter(surgery_length_of_duration >= 0 & surgery_length_of_duration < 60))/nrow(asa2))*100   
(nrow(asa2 %>% filter(surgery_length_of_duration >= 60 & surgery_length_of_duration < 120))/nrow(asa2))*100  
(nrow(asa2 %>% filter(surgery_length_of_duration >= 120 & surgery_length_of_duration < 180))/nrow(asa2))*100   
(nrow(asa2 %>% filter(surgery_length_of_duration >= 180 & surgery_length_of_duration < 240))/nrow(asa2))*100   
(nrow(asa2 %>% filter(surgery_length_of_duration >= 240 & surgery_length_of_duration < 300))/nrow(asa2))*100   
(nrow(asa2 %>% filter(surgery_length_of_duration >= 300 & surgery_length_of_duration < 360))/nrow(asa2))*100 
(nrow(asa2 %>% filter(surgery_length_of_duration >= 360 & surgery_length_of_duration < 420))/nrow(asa2))*100 
(nrow(asa2 %>% filter(surgery_length_of_duration >= 420 & surgery_length_of_duration < 480))/nrow(asa2))*100 
(nrow(asa2 %>% filter(surgery_length_of_duration >= 480 & surgery_length_of_duration < 540))/nrow(asa2))*100 
(nrow(asa2 %>% filter(surgery_length_of_duration >= 540 & surgery_length_of_duration < 600))/nrow(asa2))*100 
(nrow(asa2 %>% filter(surgery_length_of_duration >= 600))/nrow(asa2))*100   
  
```
```{r}
(nrow(asa3 %>% filter(surgery_length_of_duration < 0))/nrow(asa3))*100   
(nrow(asa3 %>% filter(surgery_length_of_duration >= 0 & surgery_length_of_duration < 60))/nrow(asa3))*100   
(nrow(asa3 %>% filter(surgery_length_of_duration >= 60 & surgery_length_of_duration < 120))/nrow(asa3))*100  
(nrow(asa3 %>% filter(surgery_length_of_duration >= 120 & surgery_length_of_duration < 180))/nrow(asa3))*100   
(nrow(asa3 %>% filter(surgery_length_of_duration >= 180 & surgery_length_of_duration < 240))/nrow(asa3))*100   
(nrow(asa3 %>% filter(surgery_length_of_duration >= 240 & surgery_length_of_duration < 300))/nrow(asa3))*100   
(nrow(asa3 %>% filter(surgery_length_of_duration >= 300 & surgery_length_of_duration < 360))/nrow(asa3))*100 
(nrow(asa3 %>% filter(surgery_length_of_duration >= 360 & surgery_length_of_duration < 420))/nrow(asa3))*100 
(nrow(asa3 %>% filter(surgery_length_of_duration >= 420 & surgery_length_of_duration < 480))/nrow(asa3))*100 
(nrow(asa3 %>% filter(surgery_length_of_duration >= 480 & surgery_length_of_duration < 540))/nrow(asa3))*100 
(nrow(asa3 %>% filter(surgery_length_of_duration >= 540 & surgery_length_of_duration < 600))/nrow(asa3))*100 
(nrow(asa3 %>% filter(surgery_length_of_duration >= 600))/nrow(asa3))*100   
  
```


```{r}
(nrow(asa4 %>% filter(surgery_length_of_duration < 0))/nrow(asa4))*100   
(nrow(asa4 %>% filter(surgery_length_of_duration >= 0 & surgery_length_of_duration < 60))/nrow(asa4))*100   
(nrow(asa4 %>% filter(surgery_length_of_duration >= 60 & surgery_length_of_duration < 120))/nrow(asa4))*100  
(nrow(asa4 %>% filter(surgery_length_of_duration >= 120 & surgery_length_of_duration < 180))/nrow(asa4))*100   
(nrow(asa4 %>% filter(surgery_length_of_duration >= 180 & surgery_length_of_duration < 240))/nrow(asa4))*100   
(nrow(asa4 %>% filter(surgery_length_of_duration >= 240 & surgery_length_of_duration < 300))/nrow(asa4))*100   
(nrow(asa4 %>% filter(surgery_length_of_duration >= 300 & surgery_length_of_duration < 360))/nrow(asa4))*100 
(nrow(asa4 %>% filter(surgery_length_of_duration >= 360 & surgery_length_of_duration < 420))/nrow(asa4))*100 
(nrow(asa4 %>% filter(surgery_length_of_duration >= 420 & surgery_length_of_duration < 480))/nrow(asa4))*100 
(nrow(asa4 %>% filter(surgery_length_of_duration >= 480 & surgery_length_of_duration < 540))/nrow(asa4))*100 
(nrow(asa4 %>% filter(surgery_length_of_duration >= 540 & surgery_length_of_duration < 600))/nrow(asa4))*100 
(nrow(asa4 %>% filter(surgery_length_of_duration >= 600))/nrow(asa4))*100   
```
```{r}
(nrow(asa5 %>% filter(surgery_length_of_duration < 0))/nrow(asa5))*100   
(nrow(asa5 %>% filter(surgery_length_of_duration >= 0 & surgery_length_of_duration < 60))/nrow(asa5))*100   
(nrow(asa5 %>% filter(surgery_length_of_duration >= 60 & surgery_length_of_duration < 120))/nrow(asa5))*100  
(nrow(asa5 %>% filter(surgery_length_of_duration >= 120 & surgery_length_of_duration < 180))/nrow(asa5))*100   
(nrow(asa5 %>% filter(surgery_length_of_duration >= 180 & surgery_length_of_duration < 240))/nrow(asa5))*100   
(nrow(asa5 %>% filter(surgery_length_of_duration >= 240 & surgery_length_of_duration < 300))/nrow(asa5))*100   
(nrow(asa5 %>% filter(surgery_length_of_duration >= 300 & surgery_length_of_duration < 360))/nrow(asa5))*100 
(nrow(asa5 %>% filter(surgery_length_of_duration >= 360 & surgery_length_of_duration < 420))/nrow(asa5))*100 
(nrow(asa5 %>% filter(surgery_length_of_duration >= 420 & surgery_length_of_duration < 480))/nrow(asa5))*100 
(nrow(asa5 %>% filter(surgery_length_of_duration >= 480 & surgery_length_of_duration < 540))/nrow(asa5))*100 
(nrow(asa5 %>% filter(surgery_length_of_duration >= 540 & surgery_length_of_duration < 600))/nrow(asa5))*100 
(nrow(asa5 %>% filter(surgery_length_of_duration >= 600))/nrow(asa5))*100   

```
No son datos muy concluyentes
```{r}
(nrow(conjuntas %>% filter(surgery_length_of_duration < 0))/nrow(conjuntas))*100   
(nrow(conjuntas %>% filter(surgery_length_of_duration >= 0 & surgery_length_of_duration < 60))/nrow(conjuntas))*100   
(nrow(conjuntas %>% filter(surgery_length_of_duration >= 60 & surgery_length_of_duration < 120))/nrow(conjuntas))*100  
(nrow(conjuntas %>% filter(surgery_length_of_duration >= 120 & surgery_length_of_duration < 180))/nrow(conjuntas))*100   
(nrow(conjuntas %>% filter(surgery_length_of_duration >= 180 & surgery_length_of_duration < 240))/nrow(conjuntas))*100   
(nrow(conjuntas %>% filter(surgery_length_of_duration >= 240 & surgery_length_of_duration < 300))/nrow(conjuntas))*100   
(nrow(conjuntas %>% filter(surgery_length_of_duration >= 300 & surgery_length_of_duration < 360))/nrow(conjuntas))*100 
(nrow(conjuntas %>% filter(surgery_length_of_duration >= 360 & surgery_length_of_duration < 420))/nrow(conjuntas))*100 
(nrow(conjuntas %>% filter(surgery_length_of_duration >= 420 & surgery_length_of_duration < 480))/nrow(conjuntas))*100 
(nrow(conjuntas %>% filter(surgery_length_of_duration >= 480 & surgery_length_of_duration < 540))/nrow(conjuntas))*100 
(nrow(conjuntas %>% filter(surgery_length_of_duration >= 540 & surgery_length_of_duration < 600))/nrow(conjuntas))*100 
(nrow(conjuntas %>% filter(surgery_length_of_duration >= 600))/nrow(conjuntas))*100   
   
```
```{r}
(nrow(individuales %>% filter(surgery_length_of_duration < 0))/nrow(individuales))*100   
(nrow(individuales %>% filter(surgery_length_of_duration >= 0 & surgery_length_of_duration < 60))/nrow(individuales))*100   
(nrow(individuales %>% filter(surgery_length_of_duration >= 60 & surgery_length_of_duration < 120))/nrow(individuales))*100  
(nrow(individuales %>% filter(surgery_length_of_duration >= 120 & surgery_length_of_duration < 180))/nrow(individuales))*100   
(nrow(individuales %>% filter(surgery_length_of_duration >= 180 & surgery_length_of_duration < 240))/nrow(individuales))*100   
(nrow(individuales %>% filter(surgery_length_of_duration >= 240 & surgery_length_of_duration < 300))/nrow(individuales))*100   
(nrow(individuales %>% filter(surgery_length_of_duration >= 300 & surgery_length_of_duration < 360))/nrow(individuales))*100 
(nrow(individuales %>% filter(surgery_length_of_duration >= 360 & surgery_length_of_duration < 420))/nrow(individuales))*100 
(nrow(individuales %>% filter(surgery_length_of_duration >= 420 & surgery_length_of_duration < 480))/nrow(individuales))*100 
(nrow(individuales %>% filter(surgery_length_of_duration >= 480 & surgery_length_of_duration < 540))/nrow(individuales))*100 
(nrow(individuales %>% filter(surgery_length_of_duration >= 540 & surgery_length_of_duration < 600))/nrow(individuales))*100 
(nrow(individuales %>% filter(surgery_length_of_duration >= 600))/nrow(individuales))*100   
```

Cuando solo se aplica una anestesia la operacón suele durar 2 horas, sin embargo al aplicar solo 1 suele durar más una hora
```{r}
HOSP <- LOD %>%
  filter(character_of_intervention == "HOSP")
HOSP
```

```{r}
AMB <- LOD %>%
  filter(character_of_intervention == "AMB")
AMB
```
```{r}
(nrow(AMB %>% filter(surgery_length_of_duration < 0))/nrow(AMB))*100   
(nrow(AMB %>% filter(surgery_length_of_duration >= 0 & surgery_length_of_duration < 60))/nrow(AMB))*100   
(nrow(AMB %>% filter(surgery_length_of_duration >= 60 & surgery_length_of_duration < 120))/nrow(AMB))*100  
(nrow(AMB %>% filter(surgery_length_of_duration >= 120 & surgery_length_of_duration < 180))/nrow(AMB))*100   
(nrow(AMB %>% filter(surgery_length_of_duration >= 180 & surgery_length_of_duration < 240))/nrow(AMB))*100   
(nrow(AMB %>% filter(surgery_length_of_duration >= 240 & surgery_length_of_duration < 300))/nrow(AMB))*100   
(nrow(AMB %>% filter(surgery_length_of_duration >= 300 & surgery_length_of_duration < 360))/nrow(AMB))*100 
(nrow(AMB %>% filter(surgery_length_of_duration >= 360 & surgery_length_of_duration < 420))/nrow(AMB))*100 
(nrow(AMB %>% filter(surgery_length_of_duration >= 420 & surgery_length_of_duration < 480))/nrow(AMB))*100 
(nrow(AMB %>% filter(surgery_length_of_duration >= 480 & surgery_length_of_duration < 540))/nrow(AMB))*100 
(nrow(AMB %>% filter(surgery_length_of_duration >= 540 & surgery_length_of_duration < 600))/nrow(AMB))*100 
(nrow(AMB %>% filter(surgery_length_of_duration >= 600))/nrow(AMB))*100   
  
```
```{r}
(nrow(HOSP %>% filter(surgery_length_of_duration < 0))/nrow(HOSP))*100   
(nrow(HOSP %>% filter(surgery_length_of_duration >= 0 & surgery_length_of_duration < 60))/nrow(HOSP))*100   
(nrow(HOSP %>% filter(surgery_length_of_duration >= 60 & surgery_length_of_duration < 120))/nrow(HOSP))*100  
(nrow(HOSP %>% filter(surgery_length_of_duration >= 120 & surgery_length_of_duration < 180))/nrow(HOSP))*100   
(nrow(HOSP %>% filter(surgery_length_of_duration >= 180 & surgery_length_of_duration < 240))/nrow(HOSP))*100   
(nrow(HOSP %>% filter(surgery_length_of_duration >= 240 & surgery_length_of_duration < 300))/nrow(HOSP))*100   
(nrow(HOSP %>% filter(surgery_length_of_duration >= 300 & surgery_length_of_duration < 360))/nrow(HOSP))*100 
(nrow(HOSP %>% filter(surgery_length_of_duration >= 360 & surgery_length_of_duration < 420))/nrow(HOSP))*100 
(nrow(HOSP %>% filter(surgery_length_of_duration >= 420 & surgery_length_of_duration < 480))/nrow(HOSP))*100 
(nrow(HOSP %>% filter(surgery_length_of_duration >= 480 & surgery_length_of_duration < 540))/nrow(HOSP))*100 
(nrow(HOSP %>% filter(surgery_length_of_duration >= 540 & surgery_length_of_duration < 600))/nrow(HOSP))*100 
(nrow(HOSP %>% filter(surgery_length_of_duration >= 600))/nrow(HOSP))*100   

  
```
Lo mismo pasa con el caracter de la intervención, AMB suelen durar menos que HOSP

```{r}
(nrow(AMB %>% filter(main_procedure == 13.41))/nrow(AMB))*100   
```
Vamos a ver cuales son los 10 procedimientos que más se repiten

```{r}
# Suponiendo que tienes un dataframe llamado datos y quieres ver los valores más repetidos en la columna "columna"
# Puedes usar la función table() para contar la frecuencia de cada valor en la columna
frecuencias <- table(LOD$main_procedure)

# Luego, puedes ordenar las frecuencias de mayor a menor
frecuencias_ordenadas <- sort(frecuencias, decreasing = TRUE)


# Para ver los valores más repetidos, puedes tomar los primeros n elementos
n <- 10 # Por ejemplo, si quieres ver los 5 valores más repetidos
valores_mas_repetidos <- (frecuencias_ordenadas)[1:n]

# Ahora, imprime los valores más repetidos
print(valores_mas_repetidos)
```
```{r}
# Suponiendo que tienes un dataframe llamado datos y quieres ver los valores más repetidos en la columna "columna"
# Puedes usar la función table() para contar la frecuencia de cada valor en la columna
frecuencias <- table(LOD$main_condition)

# Luego, puedes ordenar las frecuencias de mayor a menor
frecuencias_ordenadas <- sort(frecuencias, decreasing = TRUE)

# Para ver los valores más repetidos, puedes tomar los primeros n elementos
n <- 10 # Por ejemplo, si quieres ver los 5 valores más repetidos
valores_mas_repetidos <- (frecuencias_ordenadas)[1:n]

# Ahora, imprime los valores más repetidos
print(valores_mas_repetidos)
```
```{r}
asa1 <- LOD %>% filter (asa_score == 1)
asa2 <- LOD %>% filter (asa_score == 2) 
asa3 <- LOD %>% filter (asa_score == 3)
asa4 <- LOD %>% filter (asa_score == 4) 
asa5 <- LOD %>% filter (asa_score == 5)
```
```{r}
(nrow(asa4 %>% filter(main_procedure == 13.41))/nrow(asa4))*100   
```
Vamos a filtrar las cirujías que han durado menos de 1000 minutos ya que los casos mayores se tratarán como excepciones

```{r}
positivos <- LOD %>% filter (surgery_length_of_duration >= 0 & surgery_length_of_duration < 1000)
```

vemos gráficamente como afecta el asa_score a estos datos

```{r}
plot(positivos$asa_score, positivos$surgery_length_of_duration, xlab = "Columna de Interés", ylab = "Tiempo en Quirófano")
```
Vamos a ver que valores afectan más al tiempo
```{r}
LOD$character_numeric <- ifelse(LOD$character_of_intervention == "AMB", 0, ifelse(LOD$character_of_intervention == "HOSP", 1, NA))
LOD$character_numeric <- as.integer(LOD$character_numeric)
```
```{r}
positivos <- LOD %>% filter (surgery_length_of_duration >= 0 & surgery_length_of_duration < 1000)
```


```{r}
correlation <- cor(positivos$secondary_procedure, positivos$surgery_length_of_duration)
correlation
```


```{r}
correlation <- cor(positivos$asa_score, positivos$surgery_length_of_duration)
correlation
```

```{r}
correlation <- cor(positivos$age, positivos$surgery_length_of_duration)
correlation
```
```{r}
correlation <- cor(positivos$weight, positivos$surgery_length_of_duration)
correlation
```
```{r}
correlation <- cor(positivos$height, positivos$surgery_length_of_duration)
correlation
```

```{r}
correlation <- cor(positivos$anesthesia_local, positivos$surgery_length_of_duration)
correlation
```
```{r}
correlation <- cor(positivos$anesthesia_sedation, positivos$surgery_length_of_duration)
correlation
```
```{r}
correlation <- cor(positivos$anesthesia_plexus_block, positivos$surgery_length_of_duration)
correlation
```
```{r}
correlation <- cor(positivos$anesthesia_intradural, positivos$surgery_length_of_duration)
correlation
```
```{r}
correlation <- cor(positivos$anesthesia_epidural, positivos$surgery_length_of_duration)
correlation
```
```{r}
correlation <- cor(positivos$anesthesia_general, positivos$surgery_length_of_duration)
correlation
```
```{r}
correlation <- cor(positivos$IMC, positivos$surgery_length_of_duration)
correlation
```
```{r}
correlation <- cor(positivos$character_numeric, positivos$surgery_length_of_duration)
correlation
```
```{r}
plot(positivos$character_numeric, positivos$surgery_length_of_duration, xlab = "Columna de Interés", ylab = "Tiempo en Quirófano")
```

relevantes:asa_score, local, sedation, epidural, general y character_of_intervention

```{r}
modelo <- lm(surgery_length_of_duration ~ asa_score, data = positivos)
summary(modelo)
```

13.41 23.19 38.59 51.23 57.49 81.54  4.43 53.05 85.21 83.39 81.51  86.3    64 68.29 
 9959  1779  1549  1532  1277  1144  1095  1089  1034   885   690   660   654   644 
60.29 81.08  54.4 77.51  23.1 14.74  28.3 21.88 80.51  3.09  60.5   6.4  24.4 39.27 
  627   602   511   502   483   469   429   418   406   405   392   386   385   381 
   53 68.41 49.11 82.01 53.41 53.61  86.7 68.12 49.46 68.49 68.59  80.6 55.51 85.41 
  373   373   370   365   358   354   353   332   318   317   312   306   294   293 
  8.7 82.29 49.39 56.31 86.21 86.74  67.2 81.02 
  292   289   279   274   272   272   269   268 
  
```{r}
procedures_repetidos <- c(13.41, 23.19, 38.59, 51.23, 57.49, 81.54, 4.43, 53.05, 85.21, 83.39)
```

```{r}
positivos <- positivos %>% filter (main_procedure %in% procedures_repetidos)
positivos
```
```{r}
plot(positivos$main_procedure, positivos$surgery_length_of_duration, xlab = "Columna de Interés", ylab = "Tiempo en Quirófano")
```
```{r}
# Carga la librería ggplot2 si aún no lo has hecho
install.packages("ggplot2")
library(ggplot2)
```

```{r}
# Supongamos que tienes un dataframe llamado "datos" con una columna "main_procedure" que contiene los nombres de los procedimientos y una columna "tiempo" que contiene los tiempos correspondientes.

# Crea un gráfico de barras
ggplot(positivos, aes(x = main_procedure, y = surgery_length_of_duration)) +
  geom_bar(stat = "summary", fun = "mean", fill = "skyblue", color = "black") +
  labs(title = "Tiempo promedio por procedimiento", x = "Procedimiento", y = "Tiempo promedio")

```

```{r}
# Supongamos que tienes un dataframe llamado "datos" con una columna "main_procedure" que contiene los nombres de los procedimientos y una columna "tiempo" que contiene los tiempos correspondientes.

# Crea un gráfico de barras
ggplot(positivos, aes(x = character_numeric, y = surgery_length_of_duration)) +
  geom_bar(stat = "summary", fun = "mean", fill = "skyblue", color = "black") +
  labs(title = "Tiempo promedio por carácter", x = "carácter", y = "Tiempo promedio")

```

```{r}
# Supongamos que tienes un dataframe llamado "datos" con una columna "main_procedure" que contiene los nombres de los procedimientos y una columna "tiempo" que contiene los tiempos correspondientes.

# Crea un gráfico de barras
ggplot(positivos, aes(x = asa_score, y = surgery_length_of_duration)) +
  geom_bar(stat = "summary", fun = "mean", fill = "skyblue", color = "black") +
  labs(title = "Tiempo promedio por asa_score", x = "asa_score", y = "Tiempo promedio")

```

